<!-- <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html> -->

<!DOCTYPE html>
<html lang="vi" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tailwind Utilities ‚Äî Mini Docs</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Dark mode preset from localStorage
      (function () {
        const saved = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (saved === "dark" || (!saved && prefersDark)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    <style>
      /* Smooth scrolling for in-page anchors */
      html {
        scroll-behavior: smooth;
      }
    </style>
  </head>
  <body
    class="h-full bg-white text-slate-900 dark:bg-slate-900 dark:text-slate-100"
  >
    <!-- App Shell -->
    <div class="h-screen flex">
      <!-- Sidebar (desktop) -->
      <aside
        id="sidebar"
        class="hidden md:flex md:flex-col w-72 shrink-0 border-r border-slate-200 dark:border-slate-800 bg-white/70 dark:bg-slate-900/60 backdrop-blur sticky top-0 h-screen"
      >
        <div class="p-4 border-b border-slate-200 dark:border-slate-800">
          <div class="text-lg font-semibold">Tailwind Utilities</div>
          <div class="text-xs text-slate-500 dark:text-slate-400">
            Mini-docs n·ªôi b·ªô
          </div>
        </div>
        <nav id="toc" class="flex-1 overflow-y-auto p-3 space-y-6">
          <!-- Filled by JS -->
        </nav>
        <div
          class="p-3 text-xs text-slate-500 dark:text-slate-400 border-t border-slate-200 dark:border-slate-800"
        >
          <p>¬© <span id="year"></span> Mini Docs</p>
        </div>
      </aside>

      <!-- Content column -->
      <div class="flex-1 flex flex-col min-w-0">
        <!-- Header -->
        <header
          class="sticky top-0 z-20 border-b border-slate-200 dark:border-slate-800 bg-white/70 dark:bg-slate-900/60 backdrop-blur"
        >
          <div class="flex items-center gap-2 md:gap-4 p-3">
            <button
              id="mobileMenuBtn"
              class="md:hidden inline-flex items-center justify-center rounded-xl p-2 border border-slate-200 dark:border-slate-700"
            >
              <!-- menu icon -->
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-menu"
              >
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
            <div class="hidden md:block text-sm font-medium">
              Tailwind Utilities ‚Äî Mini Docs
            </div>
            <div class="flex-1"></div>

            <!-- Level filters -->
            <div id="levelFilters" class="hidden md:flex items-center gap-2">
              <!-- Filled by JS -->
            </div>

            <!-- Search -->
            <label class="relative w-full max-w-xs">
              <svg
                class="absolute left-2 top-1/2 -translate-y-1/2"
                width="18"
                height="18"
                viewBox="0 0 20 20"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="8.5" cy="8.5" r="5.5"></circle>
                <line x1="13" y1="13" x2="18" y2="18"></line>
              </svg>
              <input
                id="search"
                type="search"
                placeholder="T√¨m nh√≥m, m·ª•c, class‚Ä¶"
                class="w-full pl-8 pr-10 py-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-white/70 dark:bg-slate-800/70 focus:outline-none focus:ring-2 focus:ring-indigo-500"
              />
              <button
                id="clearSearch"
                class="hidden absolute right-2 top-1/2 -translate-y-1/2 text-slate-500"
              >
                ‚úï
              </button>
            </label>

            <!-- Theme toggle -->
            <button
              id="themeToggle"
              class="ml-2 inline-flex items-center justify-center rounded-xl p-2 border border-slate-200 dark:border-slate-700"
              title="ƒê·ªïi theme"
            >
              <span id="themeIcon">üåô</span>
            </button>

            <!-- Export filtered JSON -->
            <button
              id="exportBtn"
              class="ml-2 hidden md:inline-flex items-center gap-1 rounded-xl px-3 py-2 border border-slate-200 dark:border-slate-700 text-sm"
              title="Xu·∫•t JSON theo b·ªô l·ªçc hi·ªán t·∫°i"
            >
              Export
            </button>
          </div>

          <!-- Level filters (mobile) -->
          <div
            id="levelFiltersMobile"
            class="md:hidden flex flex-wrap gap-2 px-3 pb-3"
          ></div>
        </header>

        <!-- Main content area -->
        <main id="content" class="flex-1 overflow-y-auto p-4 md:p-6">
          <!-- Filled by JS with category cards -->
        </main>
      </div>
    </div>

    <!-- Mobile drawer -->
    <div id="drawer" class="fixed inset-0 z-30 hidden">
      <div class="absolute inset-0 bg-black/40" data-close></div>
      <div
        class="absolute top-0 left-0 bottom-0 w-72 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 p-3 overflow-y-auto"
      >
        <div class="flex items-center justify-between mb-3">
          <div class="font-semibold">M·ª•c l·ª•c</div>
          <button data-close class="rounded-lg border px-2 py-1">ƒê√≥ng</button>
        </div>
        <nav id="tocMobile" class="space-y-6"></nav>
      </div>
    </div>

    <script>
      // ---------- Configuration ----------
      const FILES = [
        "tailwind-easy.json",
        "tailwind-medium.json",
        "tailwind-hard.json",
        "tailwind-very-hard.json",
      ];

      const LEVEL_META = {
        easy: { label: "D·ªÖ", color: "bg-emerald-600" },
        medium: { label: "Trung b√¨nh", color: "bg-amber-600" },
        hard: { label: "Kh√≥", color: "bg-rose-600" },
        "very-hard": { label: "R·∫•t kh√≥", color: "bg-indigo-600" },
      };

      const STATE = {
        search: "",
        levels: new Set(["easy", "medium", "hard", "very-hard"]),
      };

      const $ = (sel, root = document) => root.querySelector(sel);
      const $$ = (sel, root = document) =>
        Array.from(root.querySelectorAll(sel));

      function slugify(str) {
        return str
          .toLowerCase()
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "")
          .replace(/[^a-z0-9]+/g, "-")
          .replace(/(^-|-$)/g, "");
      }

      // ---------- Data loading ----------
      async function loadData() {
        const results = await Promise.all(
          FILES.map((f) =>
            fetch(f)
              .then((r) => (r.ok ? r.json() : null))
              .catch(() => null)
          )
        );
        const data = results.filter(Boolean);
        if (!data.length) return getFallbackData();
        return data;
      }

      function getFallbackData() {
        // Minimal fallback so the UI renders even if JSON files are missing
        return [
          {
            level: "easy",
            categories: [
              {
                name: "Typography",
                description: "Ki·ªÉu ch·ªØ c∆° b·∫£n",
                items: [
                  {
                    name: "font-size",
                    desc: "C·ª° ch·ªØ",
                    class_examples: ["text-base", "text-lg", "text-2xl"],
                  },
                  {
                    name: "text-color",
                    desc: "M√†u ch·ªØ",
                    class_examples: ["text-slate-900", "text-emerald-600"],
                  },
                ],
              },
            ],
          },
        ];
      }

      function normalize(datasetArray) {
        // Flatten into categories enriched with level
        const categories = [];
        for (const ds of datasetArray) {
          const level = ds.level || "easy";
          const cats = ds.categories || [];
          for (const c of cats) {
            categories.push({
              id: `${level}-${slugify(c.name)}`,
              level,
              name: c.name,
              description: c.description || "",
              items: (c.items || []).map((it) => ({
                name: it.name,
                desc: it.desc || "",
                class_examples: Array.isArray(it.class_examples)
                  ? it.class_examples
                  : [],
              })),
            });
          }
        }
        return categories;
      }

      // ---------- Rendering ----------
      function renderLevelFilters(container) {
        container.innerHTML = "";
        for (const key of Object.keys(LEVEL_META)) {
          const active = STATE.levels.has(key);
          const meta = LEVEL_META[key];
          const btn = document.createElement("button");
          btn.className = `text-xs md:text-sm rounded-full px-3 py-1.5 border transition ${
            active
              ? "border-transparent text-white " + meta.color
              : "border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800"
          }`;
          btn.textContent = meta.label;
          btn.dataset.level = key;
          btn.addEventListener("click", () => {
            if (STATE.levels.has(key)) STATE.levels.delete(key);
            else STATE.levels.add(key);
            renderAll();
          });
          container.appendChild(btn);
        }
      }

      function matchesSearch(cat) {
        if (!STATE.search) return true;
        const q = STATE.search.toLowerCase();
        if (cat.name.toLowerCase().includes(q)) return true;
        if ((cat.description || "").toLowerCase().includes(q)) return true;
        for (const it of cat.items) {
          if (it.name.toLowerCase().includes(q)) return true;
          if ((it.desc || "").toLowerCase().includes(q)) return true;
          if (it.class_examples.some((ex) => ex.toLowerCase().includes(q)))
            return true;
        }
        return false;
      }

      function renderContent(categories) {
        const root = $("#content");
        root.innerHTML = "";

        const filtered = categories
          .filter((c) => STATE.levels.has(c.level))
          .filter(matchesSearch);

        if (!filtered.length) {
          root.innerHTML = `<div class="text-center text-slate-500 mt-16">Kh√¥ng c√≥ m·ª•c n√†o kh·ªõp b·ªô l·ªçc/t·ª´ kh√≥a.</div>`;
          return;
        }

        // Group by level for section headings
        const groups = filtered.reduce((acc, c) => {
          (acc[c.level] ||= []).push(c);
          return acc;
        }, {});

        const frag = document.createDocumentFragment();

        for (const level of Object.keys(LEVEL_META)) {
          const list = groups[level];
          if (!list || !list.length) continue;

          const meta = LEVEL_META[level];
          const h = document.createElement("h2");
          h.className =
            "flex items-center gap-2 text-lg md:text-xl font-semibold mt-6 mb-3";
          h.innerHTML = `<span class="inline-block w-2 h-2 rounded-full ${meta.color}"></span>${meta.label}`;
          frag.appendChild(h);

          for (const cat of list) {
            const section = document.createElement("section");
            section.id = cat.id;
            section.className =
              "mb-4 md:mb-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-slate-900/50 backdrop-blur";

            const head = document.createElement("div");
            head.className =
              "px-4 md:px-5 py-3 md:py-4 border-b border-slate-200 dark:border-slate-800 flex items-start md:items-center gap-3";
            head.innerHTML = `
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2">
                <a href="#${cat.id}" class="font-semibold hover:underline">${
              cat.name
            }</a>
                <span class="text-[10px] px-2 py-0.5 rounded-full text-white ${
                  meta.color
                }">${meta.label}</span>
              </div>
              ${
                cat.description
                  ? `<p class="text-sm text-slate-600 dark:text-slate-400 line-clamp-2">${cat.description}</p>`
                  : ""
              }
            </div>
            <button class="toggleBtn text-xs rounded-lg border px-2 py-1">Thu g·ªçn</button>
          `;
            section.appendChild(head);

            const listWrap = document.createElement("div");
            listWrap.className =
              "divide-y divide-slate-200 dark:divide-slate-800";

            for (const item of cat.items) {
              const row = document.createElement("div");
              row.className =
                "px-4 md:px-5 py-3 md:py-4 grid grid-cols-1 md:grid-cols-3 gap-3";

              const left = document.createElement("div");
              left.innerHTML = `
              <div class="font-medium">${item.name}</div>
              ${
                item.desc
                  ? `<div class="text-sm text-slate-600 dark:text-slate-400">${item.desc}</div>`
                  : ""
              }
            `;

              const right = document.createElement("div");
              right.className =
                "md:col-span-2 flex flex-wrap gap-2 content-start";

              const all = [];
              for (const ex of item.class_examples) {
                all.push(ex);
                const chip = document.createElement("button");
                chip.className =
                  "px-2.5 py-1 rounded-lg bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 font-mono text-xs hover:bg-slate-200 dark:hover:bg-slate-700";
                chip.textContent = ex;
                chip.title = "Nh·∫•p ƒë·ªÉ copy";
                chip.addEventListener("click", async () => {
                  await navigator.clipboard.writeText(ex);
                  chip.classList.add("ring-2", "ring-emerald-500");
                  setTimeout(
                    () => chip.classList.remove("ring-2", "ring-emerald-500"),
                    400
                  );
                });
                right.appendChild(chip);
              }

              // Copy all button
              if (all.length) {
                const copyAll = document.createElement("button");
                copyAll.className =
                  "ml-auto md:ml-0 px-2.5 py-1 rounded-lg border border-slate-300 dark:border-slate-700 text-xs hover:bg-slate-100 dark:hover:bg-slate-800";
                copyAll.textContent = "Copy t·∫•t c·∫£";
                copyAll.addEventListener("click", async () => {
                  await navigator.clipboard.writeText(all.join(" "));
                  copyAll.textContent = "ƒê√£ copy!";
                  setTimeout(() => (copyAll.textContent = "Copy t·∫•t c·∫£"), 700);
                });
                right.appendChild(copyAll);
              }

              row.appendChild(left);
              row.appendChild(right);
              listWrap.appendChild(row);
            }

            section.appendChild(listWrap);
            frag.appendChild(section);
          }
        }

        root.appendChild(frag);

        // Toggle collapse handlers
        $$(".toggleBtn", root).forEach((btn) => {
          btn.addEventListener("click", (e) => {
            const section = e.currentTarget.closest("section");
            const list = section.querySelector(":scope > div.divide-y");
            const collapsed = list.classList.toggle("hidden");
            e.currentTarget.textContent = collapsed ? "M·ªü r·ªông" : "Thu g·ªçn";
          });
        });
      }

      function renderToC(categories) {
        function makeList(rootEl) {
          rootEl.innerHTML = "";
          const byLevel = categories.reduce((acc, c) => {
            (acc[c.level] ||= []).push(c);
            return acc;
          }, {});
          for (const level of Object.keys(LEVEL_META)) {
            const list = byLevel[level];
            if (!list) continue;
            const h = document.createElement("div");
            h.className =
              "text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400";
            h.textContent = LEVEL_META[level].label;
            rootEl.appendChild(h);

            const ul = document.createElement("ul");
            ul.className = "mt-2 space-y-1";
            for (const c of list) {
              const li = document.createElement("li");
              const a = document.createElement("a");
              a.href = `#${c.id}`;
              a.className =
                "block px-2 py-1 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800";
              a.textContent = c.name;
              li.appendChild(a);
              ul.appendChild(li);
            }
            rootEl.appendChild(ul);
          }
        }

        makeList($("#toc"));
        makeList($("#tocMobile"));
      }

      function updateClearBtn() {
        const clearBtn = $("#clearSearch");
        const has = STATE.search && STATE.search.length > 0;
        clearBtn.classList.toggle("hidden", !has);
      }

      function exportFiltered(categories) {
        const filtered = categories
          .filter((c) => STATE.levels.has(c.level))
          .filter(matchesSearch);
        const blob = new Blob(
          [JSON.stringify({ categories: filtered }, null, 2)],
          { type: "application/json" }
        );
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "tailwind-docs-filtered.json";
        a.click();
        setTimeout(() => URL.revokeObjectURL(url), 500);
      }

      // ---------- Boot ----------
      let CATEGORIES = [];
      async function boot() {
        $("#year").textContent = new Date().getFullYear();

        const ds = await loadData();
        CATEGORIES = normalize(ds);

        renderLevelFilters($("#levelFilters"));
        renderLevelFilters($("#levelFiltersMobile"));
        renderToC(CATEGORIES);
        renderContent(CATEGORIES);

        // Search events
        const search = $("#search");
        const clear = $("#clearSearch");
        search.addEventListener("input", () => {
          STATE.search = search.value.trim();
          updateClearBtn();
          renderContent(CATEGORIES);
        });
        clear.addEventListener("click", () => {
          search.value = "";
          STATE.search = "";
          updateClearBtn();
          renderContent(CATEGORIES);
        });

        // Theme toggle
        $("#themeToggle").addEventListener("click", () => {
          const root = document.documentElement;
          const dark = root.classList.toggle("dark");
          localStorage.setItem("theme", dark ? "dark" : "light");
          $("#themeIcon").textContent = dark ? "‚òÄÔ∏è" : "üåô";
        });
        // Initialize theme icon state
        $("#themeIcon").textContent =
          document.documentElement.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";

        // Export
        $("#exportBtn").addEventListener("click", () =>
          exportFiltered(CATEGORIES)
        );

        // Mobile drawer
        const drawer = $("#drawer");
        $("#mobileMenuBtn").addEventListener("click", () =>
          drawer.classList.remove("hidden")
        );
        $$("[data-close]", drawer).forEach((el) =>
          el.addEventListener("click", () => drawer.classList.add("hidden"))
        );
      }

      boot();
    </script>
  </body>
</html>
